CREATE TABLE TARGET_TABLE(SEQ_KEY INT,ID INT,VALIDNAME VARCHAR,ADDRESS VARCHAR,LOCATION VARCHAR,AREACODE VARCHAR,LOAD_DATE DATE);


SELECT * FROM TARGET_TABLE;

SEQ_KEY  ---> AUTO INCREMENT
ID ----> 1:1
VALIDNAME ---> PREFIX NAME WITH SNOWFLAKE
ADDRESS--> 1:1
LOCATION --> 1:1
AREACODE --> AFTER SPACE WHAT EVER PRESENT IN THE ADDRESS GET THAT VALUE
LOAD_DATE --> WHAT EVER TIME WE ARE LOADING KEEP THAT DATE


INSERT INTO "TARGET_DB"."PUBLIC"."TARGET_TABLE"
SELECT SEQ.NEXTVAL AS SEQ_KEY,
ID AS ID,
CONCAT('SNOWFLAKE',NAME) AS VALIDNAME,
ADDRESS AS ADDRESS,
LOCATION AS LOCATION,
SUBSTRING(ADDRESS, CHARINDEX (' ', ADDRESS) +1, LEN(ADDRESS)) AS AREACODE,
CURRENT_TIMESTAMP() AS LOAD_DATE
FROM "SOURCE_DB"."SOURCE_SCHEMA"."SOURCE_TABLE";
