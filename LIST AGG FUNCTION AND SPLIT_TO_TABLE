CREATE DATABASE AGG;

CREATE TABLE FUNCTION (ID INT,NAME VARCHAR);

INSERT INTO FUNCTION VALUES(1,'A');

INSERT INTO FUNCTION VALUES(1,'B');

INSERT INTO FUNCTION VALUES(1,'C');

INSERT INTO FUNCTION VALUES(1,'D');

INSERT INTO FUNCTION VALUES(1,'E');

INSERT INTO FUNCTION VALUES(1,'F');

INSERT INTO FUNCTION VALUES (2,'G');

INSERT INTO FUNCTION VALUES (2,'H');

INSERT INTO FUNCTION VALUES (2,'I');

SELECT * FROM FUNCTION;

SELECT ID,LISTAGG(NAME,' ') WITHIN GROUP (ORDER BY NAME) AS RESULT FROM FUNCTION GROUP BY ID;


CREATE DATABASE AGGRIGATE;

CREATE TABLE DATA (ID INT,NAME VARCHAR);

INSERT INTO DATA VALUES(1,'A B C D E');
INSERT INTO DATA VALUES (2,'F G H');

SELECT * FROM DATA;


SELECT ID,'NAME' FROM STRING_SPLIT('A,B,C,D,E,F,G,H',',') ORDER BY ID;


SELECT NAME,STRING_SPLIT(NAME,',') FROM DATA ORDER BY ID;








CREATE DATABASE ANALYTICS;

CREATE TABLE DEMO (ID NUMBER,NAME VARCHAR);

INSERT INTO DEMO VALUES(1,'A,B,C,D,E');

INSERT INTO DEMO VALUES(2,'F,G,H');

SELECT * FROM "ANALYTICS"."PUBLIC"."DEMO";

SELECT ID,
A.VALUE::STRING AS RESULT
FROM "ANALYTICS"."PUBLIC"."DEMO",
LATERAL FLATTEN(INPUT=>SPLIT(NAME,','))A;

    
      
CREATE TABLE FUNCTION (ID INT ,NAME VARCHAR);

INSERT INTO FUNCTION VALUES (1,'A,B,C,D,E');
 
INSERT INTO FUNCTION VALUES (2,'F,G,H');

SELECT * FROM FUNCTION;

SELECT NAME
FROM FUNCTION,
LATERAL SPLIT_TO_TABLE(NAME,',') ORDER BY ID;

















    
    
    

CREATE TABLE TECH (ID INT, NAME VARCHAR,SAL INT);

INSERT INTO TECH VALUES (1,'RAM',1000);

INSERT INTO TECH VALUES (2,'RAM',1000);

INSERT INTO TECH VALUES (3,'RAM',1000);

INSERT INTO TECH VALUES (4,'RAM',1000);

INSERT INTO TECH VALUES (5,'RAM',1000);

INSERT INTO TECH VALUES (6,'RAM',1000);



SELECT * FROM
(
SELECT ID,ROW_NUMBER() OVER (ORDER BY ID) AS RN
FROM TECH)
WHERE RN BETWEEN 3 AND 5;



SELECT ID,ROW_NUMBER() OVER (ORDER BY ID) AS RN
FROM TEST
QUALIFY RN BETWEEN 3 AND 5;




CREATE TABLE DEMO (ID NUMBER,NAME VARCHAR);

INSERT INTO DEMO VALUES(1,'A,B,C,D,E');

INSERT INTO DEMO VALUES(2,'F,G,H');

SELECT * FROM "ANALYTICS"."PUBLIC"."DEMO"

SELECT ID,
Y.VALUE::STRING AS NEW_NAME
from "ANALYTICS"."PUBLIC"."DEMO",
LATERAL FLATTEN(INPUT=>SPLIT(NAME,','))Y;

