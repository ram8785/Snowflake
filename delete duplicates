CREATE TABLE CTS(A VARCHAR,B VARCHAR);

INSERT INTO CTS VALUES ('A',1);

INSERT INTO CTS VALUES (3,'THREE');

SELECT * FROM CTS;

SELECT CONCAT(A,B) AS RESULTS FROM CTS;

CREATE OR REPLACE TABLE CTS_2(ID STRING);

INSERT INTO CTS_2 VALUES (1);

INSERT INTO CTS_2 VALUES (2);

INSERT INTO CTS_2 VALUES (3);

INSERT INTO CTS_2 VALUES ('''''');

INSERT INTO CTS_2 VALUES (NULL);

SELECT * FROM CTS_2;

SELECT COUNT(*) FROM CTS_2;

SELECT COUNT(id) FROM CTS_2;

CREATE TABLE CTS_3(ID NUMBER,NAME VARCHAR,CITY STRING);

INSERT INTO CTS_3 VALUES (10,'HR','US');

INSERT INTO CTS_3 VALUES (10,'HR','US');

INSERT INTO CTS_3 VALUES (NULL,'HR','US');

SELECT * FROM CTS_3;

SELECT COUNT(*) FROM CTS_3;


INSERT OVERWRITE INTO CTS_3
WITH CTE AS
(SELECT *,ROW_NUMBER() OVER (PARTITION BY ID,NAME ORDER BY ID) AS RN
FROM CTS_3 )
SELECT ID,NAME FROM CTS_3 WHERE RN=1;



CREATE TABLE DUPLICATES (ID INT,NAME VARCHAR,SALARY INT);

INSERT INTO DUPLICATES VALUES (100,'RAM',100000);

INSERT INTO DUPLICATES VALUES (101,'RAM',100000);

INSERT INTO DUPLICATES VALUES (100,'RAM',100000);

INSERT INTO DUPLICATES VALUES (100,'RAM',100000);

INSERT INTO DUPLICATES VALUES (105,'REDDY',100000);

SELECT * FROM DUPLICATES;

INSERT OVERWRITE INTO DUPLICATES 
WITH CTE  AS
(SELECT *,ROW_NUMBER() OVER(PARTITION BY ID,NAME,SALARY ORDER BY ID) AS RAM FROM DUPLICATES) 
SELECT ID,NAME,SALARY FROM CTE WHERE RAM = 1;


SELECT ID,NAME,COUNT(*)
FROM DUPLICATES
GROUP BY ID,NAME
HAVING COUNT(*)>1;

